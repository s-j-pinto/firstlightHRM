
name: Daily Caregiver Data Sync

on:
  schedule:
    # Runs at 3:00 AM UTC every day.
    - cron: '0 3 * * *'
  workflow_dispatch: # Allows manual triggering for testing

jobs:
  sync_data_from_gcs:
    runs-on: ubuntu-latest
    steps:
      - name: Sync Active Caregiver Profiles
        run: |
          curl --request GET \
          --url https://care-connect-360--firstlighthomecare-hrm.us-central1.hosted.app/api/cron/sync-profiles \
          --header 'Authorization: Bearer ${{ secrets.CRON_SECRET }}' \
          --fail

      - name: Sync Caregiver Availability
        run: |
          curl --request GET \
          --url https://9000-firebase-studio-1759770880601.cluster-cxy3ise3prdrmx53pigwexthgs.cloudworkstations.dev/api/cron/sync-availability \
          --header 'Authorization: Bearer ${{ secrets.CRON_SECRET }}' \
          --fail

      - name: Sync Caregiver Preferences
        run: |
          curl --request GET \
          --url https://care-connect-360--firstlighthomecare-hrm.us-central1.hosted.app/api/cron/sync-preferences \
          --header 'Authorization: Bearer ${{ secrets.CRON_SECRET }}' \
          --fail
