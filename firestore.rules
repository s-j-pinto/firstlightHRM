/**
 * @description This ruleset enforces a strict role-based access control model for caregiver data.
 *
 * Data Structure:
 * - /caregiver_profiles/{caregiverProfileId}: Caregiver profiles, accessible only to authenticated users.
 * - /appointments/{appointmentId}: Appointment slots, accessible only to authenticated users.
 * - /interviews/{interviewId}: Interview data, accessible only to authenticated users.
 * - /caregiver_employees/{employeeId}: Caregiver employee data, accessible only to authenticated users.
 *
 * Key Security Decisions:
 * - All collections are only listable to authenticated users.
 * - Unauthenticated access is denied for all write operations.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Controls access to caregiver profiles. Only authenticated users are allowed access.
     * @path /caregiver_profiles/{caregiverProfileId}
     * @allow (get) authenticated user can read a caregiver profile
     * @allow (list) authenticated user can list caregiver profiles
     * @allow (create) creating a caregiver profile is not allowed
     * @allow (update) updating a caregiver profile is not allowed
     * @allow (delete) deleting a caregiver profile is not allowed
     * @principle Restricts access to caregiver profiles to authenticated users.
     */
    match /caregiver_profiles/{caregiverProfileId} {
      allow get: if isSignedIn();
      allow list: if isSignedIn();
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Controls access to appointment slots. Only authenticated users are allowed access.
     * @path /appointments/{appointmentId}
     * @allow (get) authenticated user can read an appointment slot
     * @allow (list) authenticated user can list appointment slots
     * @allow (create) creating an appointment slot is not allowed
     * @allow (update) updating an appointment slot is not allowed
     * @allow (delete) deleting an appointment slot is not allowed
     * @principle Restricts access to appointment slots to authenticated users.
     */
    match /appointments/{appointmentId} {
      allow get: if isSignedIn();
      allow list: if isSignedIn();
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Controls access to interview data. Only authenticated users are allowed access.
     * @path /interviews/{interviewId}
     * @allow (get) authenticated user can read an interview
     * @allow (list) authenticated user can list interviews
     * @allow (create) creating an interview is not allowed
     * @allow (update) updating an interview is not allowed
     * @allow (delete) deleting an interview is not allowed
     * @principle Restricts access to interview data to authenticated users.
     */
    match /interviews/{interviewId} {
      allow get: if isSignedIn();
      allow list: if isSignedIn();
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Controls access to caregiver employee data. Only authenticated users are allowed access.
     * @path /caregiver_employees/{employeeId}
     * @allow (get) authenticated user can read caregiver employee data
     * @allow (list) authenticated user can list caregiver employee data
     * @allow (create) creating caregiver employee data is not allowed
     * @allow (update) updating caregiver employee data is not allowed
     * @allow (delete) deleting caregiver employee data is not allowed
     * @principle Restricts access to caregiver employee data to authenticated users.
     */
    match /caregiver_employees/{employeeId} {
      allow get: if isSignedIn();
      allow list: if isSignedIn();
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }
    
     /**
     * @description Controls access to client data. No unauthenticated access is permitted
     * @path /clients
     * @allow (get) reading the client data is not allowed
     * @allow (list) listing the client data is not allowed
     * @allow (create) creating the client data is not allowed
     * @allow (update) updating the client data is not allowed
     * @allow (delete) deleting the client data is not allowed
     * @principle Restricts access to client data only to authenticated users.
     */
      match /clients/{clientId} {
        allow get: if false;
        allow list: if false;
        allow create: if false;
        allow update: if false;
        allow delete: if false;
      }
  }

  function isSignedIn() {
    return request.auth != null;
  }
}