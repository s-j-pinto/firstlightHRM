
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // PUBLIC ACCESS FOR REPORTS
    // Anyone can read single documents from these collections for the report.
    match /carelog_groups/{groupId} {
       allow get: if true;
    }
    match /Clients/{clientId} {
       allow get: if true;
    }
    // Anyone can query/list carelogs for the report page.
    match /carelogs/{logId} {
       allow list, get: if true;
    }

    // AUTHENTICATED USER RULES
    // Logged-in users can create new documents in these collections.
    match /caregiver_profiles/{profileId} {
      allow create: if request.auth != null;
      allow read, update: if request.auth != null; // Admins can read/update
    }
    match /appointments/{appointmentId} {
      allow create: if request.auth != null;
      allow read, update, delete: if request.auth != null; // Admins can manage
    }
    match /interviews/{interviewId} {
        allow create, read, update: if request.auth != null;
    }
    match /caregiver_employees/{employeeId} {
        allow create, read, update: if request.auth != null;
    }
    match /carelogs/{logId} {
        allow get, list: if true;
        allow create: if request.auth != null; // Caregivers can create logs
    }

    // Authenticated users (admins) can read from these collections.
    match /caregivers_active/{caregiverId} {
      allow read, write: if request.auth != null;
    }
     match /Clients/{clientId} {
      allow read, write: if request.auth != null;
    }
    match /carelog_groups/{groupId} {
      allow read, write: if request.auth != null;
    }
    match /settings/{settingId} {
        allow read, write: if request.auth != null;
    }
  }
}
